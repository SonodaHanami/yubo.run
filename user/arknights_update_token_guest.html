<html>
<head>
<meta charset="utf-8" />
<title>æ›´æ–°tokenæ¸¸å®¢å…¥å£ | ç¾½bot</title>
<link rel="icon" type="image/png" sizes="32x32" href="/bot/favicon_32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/bot/favicon_16.png">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MZCWWQJQQT"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-MZCWWQJQQT');
</script>
</head>
<body>
<h1>æ›´æ–°tokenæ¸¸å®¢å…¥å£</h1>
<a href="https://yubo.run/arknights/ji/">è¿”å›é›†é›†ç»Ÿè®¡æ€»æ¦œï¼ˆæš‚å®šï¼‰</a>
<div id="div_channel">
    <p><button style="transform-origin:0 0; scale: 2; margin-bottom: 2em; width: 8em;" onclick="set_channel('1')">æˆ‘æ˜¯å®˜æœç©å®¶</button></p>
    <p><button style="transform-origin:0 0; scale: 2; margin-bottom: 2em; width: 8em;" onclick="set_channel('2')">æˆ‘æ˜¯Bæœç©å®¶</button></p>
</div>
<div id="div_main" style="display: none;">
<h3>ç¬¬ä¸€æ­¥ï¼š</h3>
<p>åœ¨ <a href="https://ak.hypergryph.com/user/" target="_blank">https://ak.hypergryph.com/user/</a> ç™»å½•</p>
<h3>ç¬¬äºŒæ­¥ï¼š</h3>
<p id="p_channel_1" style="display: none;">
    <a href="https://web-api.hypergryph.com/account/info/hg" target="_blank">æ‰“å¼€è¿™ä¸ªtokené¡µé¢</a>ï¼Œä½ å°†çœ‹åˆ°å¦‚ä¸‹çš„å†…å®¹
</p>
<p id="p_channel_2" style="display: none;">
    <a href="https://web-api.hypergryph.com/account/info/ak-b" target="_blank">æ‰“å¼€è¿™ä¸ªtokené¡µé¢</a>ï¼Œä½ å°†çœ‹åˆ°å¦‚ä¸‹çš„å†…å®¹
</p>
<textarea id="textarea_token" style="width: 100%;">
{"code":0,"data":{"content":"è¿™é‡Œæ˜¯tokenï¼Œå®˜æœçš„24ä½ï¼ŒBæœçš„ä¸¤ç™¾å¤šä½"},"msg":"æ¥å£ä¼šè¿”å›æ‚¨çš„é¹°è§’ç½‘ç»œé€šè¡Œè¯è´¦å·çš„ç™»å½•å‡­è¯ï¼Œæ­¤å‡­è¯å¯ä»¥ç”¨äºé¹°è§’ç½‘ç»œè´¦å·ç³»ç»Ÿæ ¡éªŒæ‚¨ç™»å½•çš„æœ‰æ•ˆæ€§ã€‚æ³„éœ²ç™»å½•å‡­è¯å±äºæåº¦å±é™©æ“ä½œï¼Œä¸ºäº†æ‚¨çš„è´¦å·å®‰å…¨ï¼Œè¯·å‹¿å°†æ­¤å‡­è¯ä»¥ä»»ä½•å½¢å¼å‘ŠçŸ¥ä»–äººï¼"}
</textarea>
<p id="p_what_is_select_all"><button class="button" id="button_what_is_select_all" onclick="what_is_select_all();">ä»€ä¹ˆå«å…¨é€‰ï¼Ÿ</button></p>
<p><span style="font-size: 4em; font-weight: bold; color: red;">å…¨é€‰</span>å¹¶å¤åˆ¶<span style="font-weight: bold; color: red;">tokené¡µé¢é‡Œçš„å†…å®¹</span>ï¼Œç²˜è´´åˆ°ä¸‹é¢tokenè¾“å…¥æ¡†é‡Œï¼Œç„¶åæäº¤</p>
<p>
    <b>æ³„éœ²ç™»å½•å‡­è¯ç¡®å®å±äºæåº¦å±é™©æ“ä½œ</b>ï¼Œå¦‚æœ‰ä»»ä½•ç–‘é—®è¯·éšæ—¶è¯¢é—®ç¾½æ³¢
    <button class="button" id="button_switch_token_usage" onclick="switch_token_usage();">ç‚¹å‡»<span id="span_switch_token_usage">å±•å¼€</span>ç¾½botå¯¹tokenèƒ½è¯·æ±‚çš„æ•°æ®çš„ä½¿ç”¨æƒ…å†µ</button></a>
</p>
<div id="div_token_usage" style="display: none;">
<p>
    åœ¨æ¸¸å®¢å…¥å£ï¼Œç¾½botå¯¹tokenèƒ½è¯·æ±‚çš„æ•°æ®çš„ä½¿ç”¨æƒ…å†µå¦‚ä¸‹ï¼š<br>
    ç¾½botèƒ½ä½¿ç”¨tokenæŸ¥è¯¢åˆ°å¹¶ä¸”ä¼šä½¿ç”¨çš„æ•°æ®ï¼šé›†æˆæˆ˜ç•¥#2-å‚€å½±ä¸çŒ©çº¢å­¤é’»ä¸ªäººç»Ÿè®¡åŠå›é¡¾ã€é›†æˆæˆ˜ç•¥#3-æ°´æœˆä¸æ·±è“ä¹‹æ ‘ä¸ªäººç»Ÿè®¡ã€é›†æˆæˆ˜ç•¥#4-æ¢ç´¢è€…çš„é“¶å‡‡æ­¢å¢ƒä¸ªäººç»Ÿè®¡<br>
    ç¾½botèƒ½ä½¿ç”¨tokenæŸ¥è¯¢åˆ°ä½†æ˜¯<b>ä¸ä¼š</b>ä½¿ç”¨çš„æ•°æ®ï¼šå……å€¼è®°å½•ã€æºçŸ³è®°å½•ã€æŠ½å¡è®°å½•<br>
</p>
</div>
<div id="div_channel_2" style="display: none;">
<h3>ç¬¬ä¸‰æ­¥ï¼š</h3>
<p>Bæœç©å®¶é™¤äº†tokenä»¥å¤–ï¼Œè¿˜éœ€è¦é¢å¤–æäº¤token2ï¼ŒåŸå› å’Œè·å–æ–¹æ³•è¯¦è§ <a href="https://yubo.run/bot/docs/update_token_b.html" target="_blank">Bæœæ›´æ–°token</a></p>
</div>
<p></p>
<hr>
<table>
    <tr>
        <td>token: </td>
        <td><input type="text" id="token"></td>
    </tr>
    <tr id="tr_token2" style="display: none;">
        <td>token2: </td>
        <td><input type="text" id="token2"></td>
    </tr>
    <tr>
        <td colspan="2">
            <input type="radio" name="token_option" id="radio_token_option_join_ji_stats_named" checked><label for="radio_token_option_join_ji_stats_named">åŠ å…¥é›†é›†ç»Ÿè®¡æ€»æ¦œï¼ˆæš‚å®šï¼‰ï¼Œå¦‚æœå·²æœ‰æ•°æ®åˆ™æ›´æ–°</label><br>
            <input type="radio" name="token_option" id="radio_token_option_join_ji_stats_anonymous"><label for="radio_token_option_join_ji_stats_anonymous"><b>åŒ¿å</b>åŠ å…¥é›†é›†ç»Ÿè®¡æ€»æ¦œï¼ˆæš‚å®šï¼‰ï¼Œå¦‚æœå·²æœ‰æ•°æ®åˆ™æ›´æ–°</label><br>
            <input type="radio" name="token_option" id="radio_token_option_exit_ji_stats"><label for="radio_token_option_exit_ji_stats">é€€å‡ºé›†é›†ç»Ÿè®¡æ€»æ¦œï¼ˆæš‚å®šï¼‰</label><br>
            <input type="checkbox" id="checkbox_token_logout"><label for="checkbox_token_logout">å¹¶ä¸”é€€å‡ºtokençš„ç™»å½•çŠ¶æ€</label><br>
        </td>
    </tr>
    <tr>
        <td id="td_submit" colspan="2">
            <button id="button_submit" onclick="set_guest_token();">æäº¤</button>
        </td>
    </tr>
</table>
<hr>
<div id="div_meter" style="display: none;"><meter id='meter' min='0' max='20' value='0' width="300px"></meter></div>
<div id="div_output">æäº¤åç»“æœåœ¨è¿™é‡Œæ˜¾ç¤º</div>
<hr>
</div>

<script>
let start = new Date();

function lock_button() {
    document.getElementById('button_submit').innerHTML = `æäº¤äº†ï¼Œè¯·ç¨å€™`;
    document.getElementById('token').disabled = true;
    document.getElementById('token2').disabled = true;
    document.getElementById('button_submit').disabled = true;
}

function unlock_button() {
    document.getElementById('button_submit').innerHTML = `æäº¤`;
    document.getElementById('token').disabled = false;
    document.getElementById('token2').disabled = false;
    document.getElementById('button_submit').disabled = false;
}

function update_meter() {
    let value = (new Date() - start) / 1000;
    document.getElementById('meter').value = value;
    if (value <= 20) {
        setTimeout(update_meter, 100);
    }
}

function set_channel(c) {
    channel = c;
    document.getElementById('div_channel').style.display = 'none';
    document.getElementById('div_main').style.display = '';
    document.getElementById(`p_channel_${channel}`).style.display = '';
    if (channel == '2') {
        document.getElementById('div_channel_2').style.display = '';
        document.getElementById('tr_token2').style.display = '';
    }
}

function set_guest_token() {
    lock_button();
    document.getElementById('div_meter').style.display = '';
    start = new Date();
    update_meter();
    document.getElementById('div_output').innerHTML = `è¯·ç¨å€™`;
    let token = document.getElementById("token").value;
    let token2 = document.getElementById("token2").value;
    if (!token || token == '') {
        document.getElementById('div_output').innerHTML = `ä¸å¯¹ä¸å¯¹ä¸å¯¹<br>è¯·æ£€æŸ¥è¾“å…¥ä¹‹åé‡è¯•`;
        unlock_button();
        return
    }
    let option = 'none';
    if (document.getElementById('radio_token_option_join_ji_stats_named').checked) {
        option = 'join_ji_stats_named';
    }
    else if (document.getElementById('radio_token_option_join_ji_stats_anonymous').checked) {
        option = 'join_ji_stats_anonymous';
    }
    else if (document.getElementById('radio_token_option_exit_ji_stats').checked) {
        option = 'exit_ji_stats';
    }
    let token_logout = document.getElementById('checkbox_token_logout').checked;
    let payload = {
        'channel': channel,
        'token': token,
        'token2': token2,
        'option': option,
        'logout': token_logout,
    }

    let xhr = new XMLHttpRequest();
    xhr.open('POST', 'https://yubo.run/api/arknights/set_guest_token', true);
    xhr.setRequestHeader("Content-type","application/json");
    xhr.timeout = 30000;
    xhr.onreadystatechange = function() {
        // readyState == 4è¯´æ˜è¯·æ±‚å·²å®Œæˆ
        if (xhr.readyState == 4 && xhr.status == 200 || xhr.status == 304) {
            // ä»æœåŠ¡å™¨è·å¾—æ•°æ®
            let data = JSON.parse(xhr.responseText);
            // console.log('load default_settings', data);
            d = new Date();
            document.getElementById('div_meter').style.display = 'none';
            document.getElementById('div_output').innerHTML = `${d}<br>${data.message}`;
            // parent.get_login_info();
            unlock_button();
        }
    };
    xhr.ontimeout = function() {
        d = new Date();
        document.getElementById('div_meter').style.display = 'none';
        document.getElementById('div_output').innerHTML = `${d}<br>è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•`;
        unlock_button();
    };
    xhr.send(JSON.stringify(payload));
}

function what_is_select_all() {
    let input = document.getElementById('textarea_token');
    input.select(); // é€‰ä¸­æ–‡æœ¬
    document.getElementById('p_what_is_select_all').innerHTML = `
        <span style="font-size: 4em; font-weight: bold; color: red;">ğŸ‘†è¿™å°±å«å…¨é€‰</span>
        <button class="button" onclick="document.getElementById('p_what_is_select_all').remove()">æˆ‘æ˜ç™½äº†</button>
    `;
}

function switch_token_usage(key) {
    if (document.getElementById('div_token_usage').style.display == 'none') {
        document.getElementById('div_token_usage').style.display = '';
        document.getElementById('span_switch_token_usage').innerHTML = 'æ”¶èµ·';
    }
    else {
        document.getElementById('div_token_usage').style.display = 'none';
        document.getElementById('span_switch_token_usage').innerHTML = 'å±•å¼€';
    }
}

function goto_user_home() {
    window.location.href = `https://yubo.run/user/`;
}

function inIframe() {
    try {
        return window.self !== window.top;
    } catch (e) {
        return true;
    }
}


</script>

</body>
</html>
